openapi: 3.0.3
info:
  title: GeekGully API
  version: 1.0.0
  description: OpenAPI specification for the GeekGully application (subset important for integration)
servers:
  - url: http://localhost:8080
security:
  - bearerAuth: []
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    ApiResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          nullable: true
          description: Payload (varies by endpoint)
          type: object
    AuthResponse:
      type: object
      properties:
        userId:
          type: integer
          format: int64
        email:
          type: string
        message:
          type: string
        token:
          type: string
    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
        password:
          type: string
    RegisterRequest:
      type: object
      required: [email, password, name]
      properties:
        email:
          type: string
        password:
          type: string
        name:
          type: string
        mobileNo:
          type: string
    UserDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        email:
          type: string
        name:
          type: string
        mobileNo:
          type: string
        status:
          type: string
        lastLogin:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        groups:
          type: array
          items:
            type: string
    PagedResponse_UserDto:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/UserDto'
        total:
          type: integer
        page:
          type: integer
        size:
          type: integer
    CmsCreateDto:
      type: object
      required: [type, categoryId, createdBy]
      properties:
        type:
          type: string
          description: ARTICLE or COURSE
        categoryId:
          type: integer
          format: int64
        contentLocation:
          type: string
        createdBy:
          type: integer
          format: int64
    CmsResponseDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        type:
          type: string
        categoryId:
          type: integer
          format: int64
        status:
          type: string
        contentLocation:
          type: string
        contentName:
          type: string
        contentType:
          type: string
        contentSize:
          type: integer
        createdBy:
          type: integer
          format: int64
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        reviewerComment:
          type: string
        reviewerId:
          type: integer
        reviewerName:
          type: string
    StoredFileInfo:
      type: object
      properties:
        path:
          type: string
        originalName:
          type: string
        contentType:
          type: string
        size:
          type: integer
paths:
  /api/users/login:
    post:
      tags: [Users]
      summary: Login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Auth response with token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '401':
          description: Unauthorized
  /api/users/register:
    post:
      tags: [Users]
      summary: Register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '200':
          description: Registered + token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
  /api/users/{id}:
    get:
      tags: [Users]
      summary: Get user by id
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User DTO
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '404':
          description: Not found
  /api/cms:
    post:
      tags: [CMS]
      summary: Create CMS record
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CmsCreateDto'
      responses:
        '200':
          description: Created CMS
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
  /api/cms/{id}/upload:
    post:
      tags: [CMS]
      summary: Upload content file for CMS item
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '200':
          description: Uploaded and metadata saved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
  /api/cms/{id}/content:
    get:
      tags: [CMS]
      summary: Download content for CMS item
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Binary file content
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        '404':
          description: Not found
  /api/cms/{id}/submit:
    post:
      tags: [CMS]
      summary: Submit CMS for review
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Submitted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
  /api/cms/{id}/publish:
    post:
      tags: [CMS]
      summary: Publish CMS
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
      responses:
        '200':
          description: Published
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
  /api/cms/{id}/send-back:
    post:
      tags: [CMS]
      summary: Send back to draft with a reviewer comment
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reviewerId:
                  type: integer
                comment:
                  type: string
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Sent back to draft
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
tags:
  - name: Users
  - name: CMS
```

